function initWebsocket(){ws=new WebSocket("ws://"+window.location.host+"/ws");try{ws.onmessage=onMessage,ws.onopen=function(){for(i=0;MODULES.length>i;i++)MODULES[i]!=null&&MODULES[i].onConnect!=void 0&&MODULES[i].onConnect();sendMessage(-1,"changePage",PAGE),sendMessage(-1,"changeLayout",LAYOUT.id)},ws.onerror=function(){console.error("There was an un-identified Web Socket error")},ws.onclose=function(){}}catch(e){console.error('Sorry, the web socket at "%s" is un-available error',WS_ADDRESS),console.log(e)}}function onMessage(e){var s=JSON.parse(e.data);switch(console.log(e.data),s.command){case"clientId":CLIENT_ID=s.message;break;case"success":showSuccessMessage(s.message);break;case"error":showErrorMessage(s.message);break;case"reload":location.reload();break;case"remote404":$("#"+s.moduleId+"-overlay").html("This remote module is not available at the moment."),$("#"+s.moduleId+"-overlay").show();break;default:$("#"+s.moduleId+"-overlay").hide()}var o=$('.gridster .module[data-module="'+s.moduleId+'"]').attr("data-size");MODULES[s.moduleId]["onMessage_"+o](s.command,s.message,s.extra)}function sendMessage(e,s,o){var a=new WebsocketMessage;a.message=o,a.id=e,a.command=s;var n=JSON.stringify(a);ws.send(n),console.log(n)}function WebsocketMessage(){this.id=-1,this.command="",this.message=""}var ws