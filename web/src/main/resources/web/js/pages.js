function changePage(a){PAGE=a,sendMessage(-1,"changePage",PAGE),getLayout(),getPages(),$("#pages-overlay, #pages").removeClass("showing"),typeof Storage!="undefined"&&localStorage.setItem("page",PAGE)}function moveModule(a){if($("#module-modal").modal("hide"),$("#page-move-modal").length==0){var e=[];e.push('<div id="page-move-modal" class="modal fade" tabindex="-1" role="dialog">','<div class="modal-dialog">','<div class="modal-content">','<div class="modal-header">','<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>','<h4 class="modal-title">Which page to move this module ?</h4>',"</div>",'<div class="modal-body">','<div class="loader"></div>',"</div>","</div>","</div>","</div>"),$("body").append(e.join(""))}else $("#page-move-modal .modal-body").html('<div class="loader"></div>');$("#page-move-modal").modal("show"),$.getJSON("/pages",function(e){var o=[];$.each(e,function(e,t){t.id!=PAGE&&o.push('<div data-id="',t.id,'" data-module="',a,'" class="page">',t.name,"</div>")}),$("#page-move-modal .modal-body").html(o.join(""))})}function moveModuleToPage(a,e){$.get("/module/"+a+"/move-to-page/"+e,function(){getLayout(),$("#page-move-modal").modal("hide"),$("#edit-layout").removeClass("editing")})}function getPages(){$.getJSON("/pages",function(a){pages2html(a)})}function pages2html(a){var e=[];$.each(a,function(a,o){o.id==PAGE&&$("#page-title .name").html(o.name),e.push('<li data-id="',o.id,'"><a class="page-name">',o.name,'</a> <i class="fa fa-pencil edit-icon" aria-hidden="true"></i>'),o.id>1&&e.push('<i class="fa fa-times edit-icon" aria-hidden="true"></i>'),e.push("</li>")}),$("#pages ul").html(e.join(""))}function addPage(a){var a=prompt("New page name");a!=void 0&&$.trim(a).length>0&&$.post("/pages/add",{name:a},function(a){pages2html(a)},"json")}function editPage(a){var e=prompt("New name",$('#pages ul li[data-id="'+a+'"] .page-name').html());e!=void 0&&$.trim(e).length>0&&$.post("/pages/edit/"+a,{name:e},function(a){pages2html(a)},"json")}function deletePage(a){confirm("Deleting this page will also delete all the modules on it. Continue ?")&&$.ajax({url:"/page/"+a,type:"DELETE",success:function(a){pages2html(a)},dataType:"json"})}$(document).ready(function(){getPages(),$("#page-title, #pages .close-panel, #pages-overlay").click(function(){$("#pages-overlay, #pages").toggleClass("showing")}),$("#pages .icons .edit").click(function(a){$("#pages").toggleClass("editing"),a.stopPropagation()}),$("#pages .add").click(function(a){addPage(),a.stopPropagation()}),$(document).on("click","#pages .edit-icon.fa-pencil",function(a){a.stopPropagation();var e=$(this).parents("li").attr("data-id");editPage(e)}),$(document).on("click","#pages .edit-icon.fa-times",function(a){a.stopPropagation();var e=$(this).parents("li").attr("data-id");deletePage(e)}),$(document).on("click",".page-name",function(){var a=$(this).parents("li").attr("data-id");changePage(a)}),$(document).on("click","#module-modal p.move",function(){moveModule($("#module-modal").attr("data-id"))}),$(document).on("click","#page-move-modal .page",function(){var a=$(this);moveModuleToPage(a.attr("data-module"),a.attr("data-id"))})})